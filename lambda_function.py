import json
import urllib
from osgeo import gdal
import numpy as np
import numpy.ma as ma
import os
import sys
import pathlib
import boto3
import copy
import glob
import io
import requests

s3 = boto3.client('s3')

def lambda_handler(event, context):
    # print(event)
    
    # Fetch S3 bucket data
    
    bucket = "geoc-cog-workspace"
    # key = event["key"] # data provided by client
#     key = {
# 	"area":{"type": "MultiPolygon", "coordinates": [[[[10.21096992, 37.09347153], [10.21096992, 37.09292221], [10.21068954, 37.09292221], [10.21068954, 37.09263992], [10.21041584, 37.09263992], [10.21041584, 37.09236145], [10.21013832, 37.09236145], [10.21013832, 37.09180069], [10.20985985, 37.0918045], [10.20985985, 37.09125137], [10.20958042, 37.09125137], [10.20958042, 37.09069061], [10.20902824, 37.09069443], [10.20902824, 37.09041595], [10.20874977, 37.09041977], [10.20874977, 37.0901413], [10.20847034, 37.0901413], [10.20847034, 37.08958054], [10.20819378, 37.08958435], [10.20819378, 37.08930588], [10.20792103, 37.08930969], [10.20792103, 37.08874893], [10.20763779, 37.08874893], [10.20763779, 37.08847046], [10.20707989, 37.08847046], [10.20707989, 37.08819962], [10.20681095, 37.08819962], [10.20681095, 37.08792114], [10.20652962, 37.08792114], [10.20652962, 37.08763885], [10.20625019, 37.08763885], [10.20625019, 37.08736038], [10.20596981, 37.08736038], [10.20596981, 37.08708191], [10.20568943, 37.08708191], [10.20568943, 37.08681107], [10.20514011, 37.08681107], [10.20514011, 37.08652878], [10.20458031, 37.08652878], [10.20458031, 37.08625031], [10.20402813, 37.08625031], [10.20402813, 37.08597183], [10.20347023, 37.08597183], [10.20347023, 37.08568954], [10.20291805, 37.08569336], [10.20291805, 37.08541489], [10.20236015, 37.0854187], [10.20236015, 37.08514023], [10.20208168, 37.08514023], [10.20208168, 37.08486176], [10.20180607, 37.08486176], [10.20180607, 37.08458328], [10.2015276, 37.08458328], [10.2015276, 37.08430481], [10.20125008, 37.08430481], [10.20125008, 37.08402634], [10.20042038, 37.08403015], [10.20042038, 37.08375168], [10.20014, 37.08375168], [10.20014, 37.08346939], [10.19986153, 37.08347321], [10.19986153, 37.08319473], [10.19958401, 37.08319473], [10.19958401, 37.08291626], [10.19902992, 37.08292007], [10.19902992, 37.0826416], [10.19791985, 37.0826416], [10.19791985, 37.08235931], [10.19735909, 37.08235931], [10.19735909, 37.08208084], [10.19708347, 37.08208466], [10.19708347, 37.08180618], [10.19680977, 37.08181], [10.19680977, 37.08153152], [10.19597054, 37.08153152], [10.19597054, 37.08124924], [10.19513893, 37.08124924], [10.19513893, 37.08097076], [10.19486141, 37.08097076], [10.19486141, 37.08069992], [10.19431019, 37.08069992], [10.19431019, 37.08042145], [10.19402885, 37.08042145], [10.19402885, 37.08013916], [10.19347095, 37.08013916], [10.19347095, 37.07986069], [10.19319057, 37.07986069], [10.19319057, 37.07958221], [10.19291687, 37.07958221], [10.19291687, 37.07930374], [10.19208336, 37.07930374], [10.19208336, 37.07902908], [10.19152737, 37.07902908], [10.19152737, 37.07875061], [10.19068813, 37.07875061], [10.19068813, 37.07847214], [10.19013882, 37.07847214], [10.19013882, 37.07819366], [10.18958282, 37.07819366], [10.18958282, 37.07791519], [10.18791866, 37.07791901], [10.18791866, 37.07764053], [10.18736076, 37.07764053], [10.18736076, 37.07736206], [10.18680668, 37.07736206], [10.18680668, 37.07764053], [10.18625069, 37.07764053], [10.18625069, 37.07736206], [10.18597031, 37.07736206], [10.18597031, 37.08013916], [10.18791866, 37.08013916], [10.18791866, 37.08042145], [10.18958092, 37.08042145], [10.18958092, 37.08069992], [10.19097137, 37.08069992], [10.19097137, 37.08097076], [10.19152737, 37.08097076], [10.19152737, 37.08124924], [10.19207764, 37.08124924], [10.19207764, 37.08153152], [10.19236088, 37.08153152], [10.19236088, 37.08181], [10.19263935, 37.08180618], [10.19263935, 37.08208466], [10.19291687, 37.08208466], [10.19291687, 37.08235931], [10.19319057, 37.08235931], [10.19319057, 37.0826416], [10.19347095, 37.08263779], [10.19347095, 37.08319473], [10.19375134, 37.08319473], [10.19375134, 37.08347321], [10.19402695, 37.08347321], [10.19402695, 37.08375168], [10.19431019, 37.08375168], [10.19431019, 37.08403015], [10.19791794, 37.08402634], [10.19791794, 37.08430481], [10.19847107, 37.08430481], [10.19847107, 37.08458328], [10.19902802, 37.08458328], [10.19902802, 37.08486176], [10.19957924, 37.08486176], [10.19957924, 37.08514023], [10.19985867, 37.08514023], [10.19985867, 37.0854187], [10.20041561, 37.08541489], [10.20041561, 37.08569336], [10.2009716, 37.08568954], [10.2009716, 37.08597183], [10.2015276, 37.08597183], [10.2015276, 37.08625031], [10.20208168, 37.08625031], [10.20208168, 37.08652878], [10.20263958, 37.08652878], [10.20263958, 37.08681107], [10.20291805, 37.08680725], [10.20291805, 37.08708191], [10.20347023, 37.08708191], [10.20347023, 37.08736038], [10.20374966, 37.08736038], [10.20374966, 37.08763885], [10.20431137, 37.08763885], [10.20431137, 37.08792114], [10.20485973, 37.08792114], [10.20485973, 37.08819962], [10.20541573, 37.0881958], [10.20541573, 37.08847046], [10.20625019, 37.08847046], [10.20625019, 37.08874893], [10.20652962, 37.08874893], [10.20652962, 37.08903122], [10.20681095, 37.08903122], [10.20681095, 37.08930969], [10.2070837, 37.08930588], [10.2070837, 37.08958435], [10.20736027, 37.08958435], [10.20736027, 37.08986282], [10.20763969, 37.08985901], [10.20763969, 37.0901413], [10.20792103, 37.0901413], [10.20792103, 37.09041977], [10.20819378, 37.09041595], [10.20819378, 37.0909729], [10.20847034, 37.09096909], [10.20847034, 37.09125137], [10.20874977, 37.09125137], [10.20874977, 37.09152985], [10.20902824, 37.09152603], [10.20902824, 37.0918045], [10.20930576, 37.0918045], [10.20930576, 37.09208298], [10.20958042, 37.09207916], [10.20958042, 37.09236145], [10.20985985, 37.09236145], [10.20985985, 37.09263992], [10.21013832, 37.09263992], [10.21013832, 37.09292221], [10.21041584, 37.0929184], [10.21041584, 37.09319305], [10.21068954, 37.09318924], [10.21068954, 37.09347153], [10.21096992, 37.09347153]]], [[[10.21096992, 37.09347153], [10.21096992, 37.09431076], [10.2112484, 37.09431076], [10.2112484, 37.09624863], [10.21153069, 37.09624863], [10.21153069, 37.09653091], [10.21180439, 37.0965271], [10.21180439, 37.09958267], [10.21207809, 37.09957886], [10.21207809, 37.10124969], [10.21292114, 37.10124969], [10.21291733, 37.10013962], [10.21263885, 37.10013962], [10.21263885, 37.0984726], [10.21291733, 37.0984726], [10.21291733, 37.09819412], [10.21263885, 37.09819412], [10.21263885, 37.09791565], [10.21236134, 37.09791946], [10.21236134, 37.09764099], [10.21207809, 37.09764099], [10.21207809, 37.09569931], [10.21180916, 37.09569931], [10.21180916, 37.09431076], [10.21153069, 37.09431076], [10.21153069, 37.09375], [10.2112484, 37.09375], [10.2112484, 37.09347153], [10.21096992, 37.09347153]]], [[[10.21791744, 37.15097046], [10.21791744, 37.15124893], [10.21874905, 37.15124893], [10.21874905, 37.15097046], [10.21902657, 37.15097046], [10.21902657, 37.15041733], [10.21874905, 37.15041733], [10.21874905, 37.14986038], [10.21847343, 37.14986038], [10.21847343, 37.14958191], [10.21791744, 37.14958191], [10.21791744, 37.14930725], [10.21763897, 37.14930725], [10.21763897, 37.14902878], [10.21736145, 37.14902878], [10.21736145, 37.14875031], [10.21708298, 37.14875031], [10.21708298, 37.14847183], [10.21680546, 37.14847183], [10.21680546, 37.14819336], [10.21652889, 37.14819336], [10.21652889, 37.14791489], [10.21541691, 37.14791489], [10.21541691, 37.14764023], [10.21513939, 37.14764023], [10.21513939, 37.14736176], [10.2145834, 37.14736176], [10.2145834, 37.14708328], [10.21430683, 37.14708328], [10.21430683, 37.14680481], [10.2140274, 37.14680481], [10.2140274, 37.14652634], [10.21347332, 37.14652634], [10.21347332, 37.14625168], [10.21319485, 37.14625168], [10.21319485, 37.14597321], [10.21291733, 37.14597321], [10.21291733, 37.14569473], [10.21263885, 37.14569473], [10.21263885, 37.14541626], [10.21236134, 37.14541626], [10.21236134, 37.14485931], [10.21208477, 37.14485931], [10.21208191, 37.14458466], [10.21180439, 37.14458466], [10.21180439, 37.14430618], [10.21152878, 37.14430618], [10.21152878, 37.14402771], [10.21125126, 37.14402771], [10.21125126, 37.14374924], [10.21097279, 37.14374924], [10.21097279, 37.14319611], [10.21069431, 37.14319611], [10.21069431, 37.14263916], [10.21041584, 37.14263916], [10.21041584, 37.14208221], [10.21013832, 37.14208221], [10.21013832, 37.14152908], [10.20985985, 37.14152908], [10.20985985, 37.13624954], [10.21013832, 37.13624954], [10.21013832, 37.13347244], [10.21041584, 37.13347244], [10.21041584, 37.13236237], [10.21069431, 37.13236237], [10.21069431, 37.13084412], [10.21069431, 37.1307373], [10.21097279, 37.13069534], [10.21097279, 37.13040543], [10.21097279, 37.12985992], [10.21129799, 37.12989044], [10.21125126, 37.12847137], [10.21152878, 37.12847137], [10.21152878, 37.1281929], [10.21180439, 37.1281929], [10.21180439, 37.12763977], [10.21208191, 37.12763977], [10.21208477, 37.12708282], [10.21236134, 37.12708282], [10.21236134, 37.12625122], [10.21263885, 37.12625122], [10.21263885, 37.12569427], [10.21291733, 37.12569427], [10.21291733, 37.12513733], [10.21319485, 37.12513733], [10.21319485, 37.1245842], [10.21347332, 37.1245842], [10.21347332, 37.12402725], [10.21375084, 37.12402725], [10.21375084, 37.12374878], [10.2140274, 37.12374878], [10.2140274, 37.12291718], [10.21430683, 37.12291718], [10.21430683, 37.12152863], [10.2145834, 37.12152863], [10.2145834, 37.12069321], [10.21486092, 37.12069321], [10.21486092, 37.11930466], [10.21430683, 37.11930466], [10.21430683, 37.11902618], [10.21319485, 37.11902618], [10.21319485, 37.11930466], [10.21291733, 37.11930466], [10.21291733, 37.11958313], [10.21263885, 37.11958313], [10.21263885, 37.1198616], [10.21236134, 37.1198616], [10.21236134, 37.12014008], [10.21208191, 37.12014008], [10.21208191, 37.12069321], [10.21180439, 37.12069321], [10.21180439, 37.12097168], [10.21152878, 37.12097168], [10.21152878, 37.12125015], [10.21125126, 37.12125015], [10.21125126, 37.12152863], [10.21097279, 37.12152863], [10.21097279, 37.1218071], [10.21069431, 37.1218071], [10.21069431, 37.12208176], [10.21041584, 37.12208176], [10.21041584, 37.1226387], [10.21013832, 37.1226387], [10.21013832, 37.12291718], [10.20985985, 37.12291718], [10.20985985, 37.12347031], [10.20958233, 37.12347412], [10.20958233, 37.12374878], [10.20930576, 37.12374878], [10.20930576, 37.12402725], [10.20902824, 37.12402725], [10.20902824, 37.1245842], [10.20874977, 37.1245842], [10.20874977, 37.12513733], [10.20847225, 37.12513733], [10.20847225, 37.12569427], [10.20819378, 37.12569427], [10.20819378, 37.12597275], [10.20791626, 37.12597275], [10.20791626, 37.12652588], [10.20763779, 37.12652588], [10.20763779, 37.12680435], [10.20736027, 37.12680435], [10.20736027, 37.12708282], [10.2070837, 37.12708282], [10.2070837, 37.12763977], [10.20680618, 37.12763977], [10.20680618, 37.1281929], [10.20652771, 37.1281929], [10.20652771, 37.12958145], [10.20625019, 37.12958145], [10.20625019, 37.12985992], [10.20597172, 37.12985992], [10.20597172, 37.1301384], [10.2056942, 37.1301384], [10.2056942, 37.13097382], [10.20541573, 37.13097382], [10.20541573, 37.13152695], [10.20514011, 37.13152695], [10.20514011, 37.13208389], [10.20485973, 37.13208389], [10.20485973, 37.13236237], [10.20458412, 37.13236237], [10.20458412, 37.1329155], [10.20430565, 37.1329155], [10.20430565, 37.13541794], [10.20402813, 37.13541794], [10.20402813, 37.13791656], [10.20430565, 37.13791656], [10.20430565, 37.13847351], [10.20458412, 37.13847351], [10.20458412, 37.13902664], [10.20485973, 37.13902664], [10.20485973, 37.13958359], [10.20514011, 37.13958359], [10.20514011, 37.14014053], [10.20541573, 37.14014053], [10.20541573, 37.14069366], [10.2056942, 37.14069366], [10.2056942, 37.14125061], [10.20597172, 37.14125061], [10.20597172, 37.14208221], [10.20625019, 37.14208221], [10.20625019, 37.14319611], [10.20652771, 37.14319611], [10.20652771, 37.14374924], [10.2070837, 37.14374924], [10.2070837, 37.14402771], [10.20736027, 37.14402771], [10.20736027, 37.14427567], [10.20736027, 37.14458466], [10.20763779, 37.14458466], [10.20763779, 37.14541626], [10.20791626, 37.14541626], [10.20791626, 37.14597321], [10.20819378, 37.14597321], [10.20819378, 37.14708328], [10.20847225, 37.14708328], [10.20847225, 37.14736176], [10.20874977, 37.14736176], [10.20874977, 37.14764023], [10.20958233, 37.14764023], [10.20958233, 37.14791489], [10.20985985, 37.14791489], [10.20985985, 37.14819336], [10.21041584, 37.14819336], [10.21041584, 37.14847183], [10.21097279, 37.14847183], [10.21097279, 37.14875031], [10.21125126, 37.14875031], [10.21125126, 37.14902878], [10.21152878, 37.14902878], [10.21152878, 37.14930725], [10.21180439, 37.14930725], [10.21180439, 37.14958191], [10.21263885, 37.14958191], [10.21264458, 37.14989853], [10.21318626, 37.14980698], [10.21319485, 37.15013885], [10.21424961, 37.15013885], [10.21652889, 37.15013885], [10.21652889, 37.15041733], [10.21708298, 37.15041733], [10.21708298, 37.1506958], [10.21763897, 37.1506958], [10.21763897, 37.15097046], [10.21791744, 37.15097046]]], [[[10.05622768, 36.84280777], [10.05585003, 36.84308243], [10.05501366, 36.84369278], [10.04629898, 36.85589218], [10.04381371, 36.85937119], [10.03952599, 36.86830139], [10.03485203, 36.8780365], [10.03294468, 36.88134384], [10.02728081, 36.89116287], [10.02641964, 36.89113617], [10.02477264, 36.89090347], [10.02381897, 36.89056778], [10.02146626, 36.88896942], [10.02046013, 36.88805389], [10.01930523, 36.88725662], [10.01828861, 36.88633347], [10.01711464, 36.88554382], [10.01608467, 36.8846283], [10.01490593, 36.88384247], [10.01387501, 36.88292694], [10.01270008, 36.8821373], [10.01167679, 36.88121796], [10.01050568, 36.88042831], [10.00948143, 36.87951279], [10.00828648, 36.87874603], [10.00746727, 36.87810898], [10.00675869, 36.87771988], [10.00417709, 36.87688828], [10.00325584, 36.87636185], [10.00247478, 36.87602615], [10.00148487, 36.87582016], [10.00040817, 36.87571335], [9.9940176, 36.87559128], [9.9928627, 36.87549973], [9.99173737, 36.87532425], [9.99067688, 36.87500381], [9.98765373, 36.87363434], [9.98608208, 36.87265015], [9.98513603, 36.87232971], [9.9840641, 36.87215424], [9.98175144, 36.87202835], [9.97887039, 36.87213898], [9.97737789, 36.87242126], [9.9769783, 36.8725853], [9.97589493, 36.87324905], [9.97507858, 36.87346649], [9.97416019, 36.87351227], [9.97369289, 36.87346649], [9.97280693, 36.87321472], [9.97077847, 36.87190247], [9.97020435, 36.87146378], [9.96842098, 36.86984253], [9.96801186, 36.86914444], [9.96773624, 36.8679657], [9.96774673, 36.8667717], [9.96792603, 36.86604691], [9.96808338, 36.86573029], [9.9688673, 36.8647728], [9.96917629, 36.86404419], [9.96936131, 36.86273193], [9.96934986, 36.86084366], [9.96920967, 36.85944748], [9.96899796, 36.8585701], [9.96881962, 36.85815048], [9.96856308, 36.85775757], [9.96819401, 36.85739899], [9.9677639, 36.85713959], [9.96730328, 36.85696411], [9.96682835, 36.85685349], [9.96586132, 36.85675812], [9.96489716, 36.85678864], [9.96397877, 36.85692978], [9.96317482, 36.85720444], [9.96208, 36.8579216], [9.96170807, 36.85808945], [9.95889187, 36.85883331], [9.95702744, 36.85954666], [9.95600414, 36.8598175], [9.95489788, 36.85995865], [9.95375156, 36.86001968], [9.94851208, 36.86000061], [9.94635201, 36.86011887], [9.94541359, 36.86030197], [9.94501209, 36.86044693], [9.94385338, 36.86108398], [9.94344139, 36.86122894], [9.94248009, 36.86141205], [9.94084454, 36.86151505], [9.93739033, 36.86156082], [9.93575954, 36.86172104], [9.93484688, 36.86198807], [9.93339729, 36.86280441], [9.93231487, 36.86313248], [9.93264961, 36.86478806], [9.93305397, 36.86553192], [9.93337727, 36.86585236], [9.93376827, 36.86609268], [9.9346447, 36.86638641], [9.93697834, 36.86669922], [9.93782711, 36.86688614], [9.93820095, 36.8670311], [9.93883419, 36.86741638], [9.94022465, 36.86843872], [9.94075012, 36.86904907], [9.94107628, 36.86984634], [9.94124889, 36.87071609], [9.9414978, 36.87490845], [9.94168282, 36.87622833], [9.94197845, 36.87704468], [9.94222736, 36.87741852], [9.94257736, 36.87775421], [9.94299984, 36.87800598], [9.94345856, 36.87818146], [9.94443703, 36.87836838], [9.9454689, 36.87843323], [9.94925404, 36.87847519], [9.95029354, 36.87856674], [9.95125675, 36.87876511], [9.95203304, 36.87910843], [9.95329857, 36.87987137], [9.95445824, 36.88037109], [9.95785141, 36.88203812], [9.95849514, 36.88246918], [9.96038342, 36.88405228], [9.9608326, 36.88471222], [9.96134853, 36.88577652], [9.96179676, 36.88642883], [9.96287441, 36.88729858], [9.96387768, 36.88821793], [9.96532536, 36.88920975], [9.96605778, 36.88990784], [9.9668684, 36.89055252], [9.96737099, 36.89115524], [9.96781254, 36.89235687], [9.96828556, 36.89499664], [9.96852493, 36.8958168], [9.96889973, 36.89653015], [9.9698, 36.89753342], [9.97001362, 36.89787674], [9.9703207, 36.89866257], [9.97064495, 36.90044785], [9.970994, 36.90421295], [9.97114754, 36.90510941], [9.97140312, 36.90594482], [9.97159386, 36.90632248], [9.97210121, 36.90691757], [9.97291088, 36.907547], [9.97390842, 36.90846252], [9.97508144, 36.90928268], [9.97559738, 36.90982437], [9.97695541, 36.91152954], [9.97749138, 36.91233444], [9.97785854, 36.91322327], [9.97808838, 36.91415024], [9.97835732, 36.91604996], [9.97860336, 36.91893005], [9.97863865, 36.92034531], [9.97848988, 36.92171478], [9.9781847, 36.9225502], [9.97677422, 36.92492676], [9.97588253, 36.92586517], [9.97549915, 36.92641449], [9.9748621, 36.92814255], [9.9744482, 36.92868042], [9.97373772, 36.92929459], [9.97290421, 36.93020248], [9.97186279, 36.93095016], [9.9709959, 36.93183136], [9.97027206, 36.93235016], [9.97094917, 36.93245697], [9.97179317, 36.93259048], [9.97679996, 36.93434906], [9.98092556, 36.93579865], [9.9889822, 36.94123077], [9.99278927, 36.94559097], [9.98651218, 36.95281982], [9.98550892, 36.95397186], [9.99054813, 36.96628189], [9.9979353, 36.97826004], [10.00024128, 36.98450089], [10.0016613, 36.99814987], [10.01018238, 37.00285339], [10.0150404, 37.00553894], [10.02712917, 37.01387024], [10.03054047, 37.01622009], [10.03964138, 37.02909088], [10.04831123, 37.04195023], [10.05782127, 37.05965042], [10.05793858, 37.06443024], [10.0579443, 37.06462097], [10.0581789, 37.07415009], [10.05708122, 37.08172989], [10.05776024, 37.08717346], [10.05796623, 37.08883286], [10.0583086, 37.09157944], [10.05763721, 37.09301376], [10.05443859, 37.09983063], [10.05014133, 37.10599899], [10.05438042, 37.11259842], [10.06420135, 37.10976028], [10.07207108, 37.1151886], [10.08082962, 37.12319565], [10.08235741, 37.12459183], [10.08325863, 37.1254158], [10.08333015, 37.12548065], [10.09142017, 37.12900925], [10.10739899, 37.13468933], [10.11872005, 37.13375854], [10.12769127, 37.13124847], [10.14347076, 37.13139343], [10.14347363, 37.13097382], [10.14374924, 37.13097382], [10.14374924, 37.13069534], [10.14430618, 37.13069534], [10.14430618, 37.13041687], [10.1445837, 37.13041687], [10.1445837, 37.1301384], [10.14486217, 37.1301384], [10.14486217, 37.12985992], [10.14513969, 37.12985992], [10.14513969, 37.12958145], [10.14569569, 37.12958145], [10.14569569, 37.12930679], [10.14624977, 37.12930679], [10.14624977, 37.12902832], [10.14680576, 37.12902832], [10.14680576, 37.12874985], [10.14819431, 37.12874985], [10.14819431, 37.12847137], [10.14847183, 37.12847137], [10.14847183, 37.1281929], [10.1493063, 37.1281929], [10.1493063, 37.12791824], [10.15097237, 37.12791824], [10.15097237, 37.12763977], [10.15152836, 37.12763977], [10.15152836, 37.1273613], [10.15235996, 37.1273613], [10.15235996, 37.12708282], [10.15291595, 37.12708282], [10.15291595, 37.12680435], [10.15375042, 37.12680435], [10.15375042, 37.12652588], [10.15430641, 37.12652588], [10.15430641, 37.12625122], [10.15513802, 37.12625122], [10.15513802, 37.12597275], [10.15680695, 37.12597275], [10.15680695, 37.12569427], [10.15736008, 37.12569427], [10.15736008, 37.1254158], [10.15902901, 37.1254158], [10.15902901, 37.12513733], [10.15986061, 37.12513733], [10.15986061, 37.12486267], [10.16069508, 37.12486267], [10.16069508, 37.1245842], [10.16208267, 37.1245842], [10.16208267, 37.12430573], [10.16263866, 37.12430573], [10.16263866, 37.12347412], [10.16319466, 37.12347031], [10.16319466, 37.12319565], [10.16347313, 37.12319565], [10.16347313, 37.12291718], [10.16402912, 37.12291718], [10.16402912, 37.1226387], [10.16458321, 37.1226387], [10.16458321, 37.12236023], [10.16625118, 37.12236023], [10.16625118, 37.1226387], [10.16652679, 37.1226387], [10.16652679, 37.12291718], [10.16902733, 37.12291718], [10.16902733, 37.1226387], [10.17014027, 37.1226387], [10.17014027, 37.12236023], [10.17319584, 37.12236023], [10.17319584, 37.1226387], [10.1740284, 37.1226387], [10.1740284, 37.12236023], [10.17458439, 37.12236023], [10.17458439, 37.1226387], [10.17652798, 37.1226387], [10.17652798, 37.12291718], [10.17736244, 37.12291718], [10.17736244, 37.12208176], [10.17763805, 37.12208176], [10.17763805, 37.12014008], [10.17791557, 37.12014008], [10.17791557, 37.11875153], [10.17819405, 37.11875153], [10.17819405, 37.11847305], [10.17847157, 37.11847305], [10.17847157, 37.11819458], [10.17958355, 37.11819458], [10.17958355, 37.11791611], [10.17986012, 37.11791611], [10.17986012, 37.11763763], [10.18013763, 37.11763763], [10.18013763, 37.11736298], [10.18041611, 37.11736298], [10.18041611, 37.1170845], [10.18124962, 37.1170845], [10.18124962, 37.11680603], [10.18180561, 37.11680603], [10.18180561, 37.11624908], [10.18208218, 37.11624908], [10.18208218, 37.11597061], [10.1823597, 37.11597061], [10.1823597, 37.11569595], [10.18263817, 37.11569595], [10.18263817, 37.11513901], [10.18291569, 37.11513901], [10.18291569, 37.11486053], [10.18319416, 37.11486053], [10.18319416, 37.11458206], [10.18347168, 37.11458206], [10.18347168, 37.1143074], [10.18402863, 37.1143074], [10.18402863, 37.11402893], [10.18458462, 37.11402893], [10.18458462, 37.11375046], [10.18486023, 37.11375046], [10.18486023, 37.11347198], [10.1851387, 37.11347198], [10.1851387, 37.11319351], [10.18569469, 37.11319351], [10.18569469, 37.11291504], [10.18625069, 37.11291504], [10.18625069, 37.11264038], [10.18680668, 37.11264038], [10.18680668, 37.11236191], [10.18736076, 37.11236191], [10.18736076, 37.11180496], [10.18763924, 37.11180496], [10.18763924, 37.11125183], [10.18791676, 37.11125183], [10.18791676, 37.11097336], [10.18819523, 37.11097336], [10.18819523, 37.11069489], [10.18902683, 37.11069489], [10.18902683, 37.11041641], [10.19236088, 37.11041641], [10.19236088, 37.11069489], [10.19263935, 37.11069489], [10.19263935, 37.11097336], [10.1954174, 37.11097336], [10.1954174, 37.11069489], [10.19902802, 37.11069489], [10.19902802, 37.11097336], [10.20430565, 37.11097336], [10.20430565, 37.11125183], [10.20652771, 37.11125183], [10.20652771, 37.11097336], [10.20874977, 37.11097336], [10.20874977, 37.11125183], [10.20985985, 37.11125183], [10.20985985, 37.11097336], [10.21208191, 37.11097336], [10.21208477, 37.11125183], [10.21236134, 37.11125183], [10.21236134, 37.11152649], [10.21291733, 37.11152649], [10.21291733, 37.11180496], [10.21430683, 37.11180496], [10.21430683, 37.11208344], [10.21513939, 37.11208344], [10.21513939, 37.11180496], [10.21652889, 37.11180496], [10.21652889, 37.11125183], [10.21680546, 37.11125183], [10.21682262, 37.11091232], [10.21736145, 37.11097336], [10.21736145, 37.11069489], [10.21847343, 37.11069489], [10.21847343, 37.11013794], [10.21819496, 37.11013794], [10.21819496, 37.10958481], [10.21652889, 37.10958481], [10.21652889, 37.10985947], [10.21541691, 37.10985947], [10.21541691, 37.11013794], [10.21419811, 37.11013794], [10.21263885, 37.11013794], [10.21263885, 37.10985947], [10.21208191, 37.10985947], [10.21210289, 37.10951996], [10.21180439, 37.10958481], [10.21180439, 37.10943222], [10.21180439, 37.10902786], [10.21152878, 37.10902786], [10.21152878, 37.10874939], [10.21125126, 37.10874939], [10.21125126, 37.10847092], [10.21097279, 37.10847092], [10.21097279, 37.10819626], [10.21069431, 37.10819626], [10.21069431, 37.10763931], [10.21097279, 37.10763931], [10.21097279, 37.10736084], [10.21236134, 37.10736084], [10.21236134, 37.10708237], [10.21263885, 37.10708237], [10.21263885, 37.10625076], [10.21236134, 37.10625076], [10.21236134, 37.10597229], [10.21180439, 37.10597229], [10.21180439, 37.10625076], [10.21069431, 37.10625076], [10.21069431, 37.10597229], [10.20958233, 37.10597229], [10.20958233, 37.10569382], [10.20930576, 37.10569382], [10.20930576, 37.10541534], [10.20902824, 37.10541534], [10.20902824, 37.10514069], [10.20874977, 37.10514069], [10.20874977, 37.10458374], [10.20680618, 37.10458374], [10.20680618, 37.10486221], [10.20458412, 37.10486221], [10.20458412, 37.10514069], [10.20347214, 37.10514069], [10.20347214, 37.10486221], [10.20263767, 37.10486221], [10.20263767, 37.10458374], [10.20236206, 37.10458374], [10.20236206, 37.10430527], [10.20208359, 37.10430527], [10.20208359, 37.10402679], [10.20180607, 37.10402679], [10.20180607, 37.10374832], [10.2015276, 37.10374832], [10.2015276, 37.10291672], [10.20125008, 37.10291672], [10.20125008, 37.10235977], [10.2015276, 37.10235977], [10.2015276, 37.10208511], [10.20236206, 37.10208511], [10.20236206, 37.10235977], [10.20347214, 37.10235977], [10.20347214, 37.10263824], [10.20430565, 37.10263824], [10.20430565, 37.10291672], [10.20485973, 37.10291672], [10.20485973, 37.10319519], [10.20625019, 37.10319519], [10.20625019, 37.10180664], [10.20597172, 37.10180664], [10.20597172, 37.10124969], [10.2056942, 37.10124969], [10.2056942, 37.10069275], [10.20514011, 37.10069275], [10.20514011, 37.10041809], [10.20485973, 37.10041809], [10.20485973, 37.09986115], [10.20430565, 37.09986115], [10.20430565, 37.09958267], [10.20402813, 37.09958267], [10.20402813, 37.0993042], [10.20347214, 37.0993042], [10.20347214, 37.09902954], [10.20319366, 37.09902954], [10.20319366, 37.09875107], [10.20291805, 37.09875107], [10.20291805, 37.0984726], [10.20236206, 37.0984726], [10.20236206, 37.09819412], [10.20180607, 37.09819412], [10.20180607, 37.09791565], [10.20069408, 37.09791565], [10.20069408, 37.09763718], [10.20041561, 37.09763718], [10.20041561, 37.09736252], [10.20014, 37.09736252], [10.20014, 37.09708405], [10.19958401, 37.09708405], [10.19958401, 37.09680557], [10.19930553, 37.09680557], [10.19930553, 37.0965271], [10.19902802, 37.0965271], [10.19902802, 37.09624863], [10.19874954, 37.09624863], [10.19874954, 37.09597397], [10.19791794, 37.09597397], [10.19791794, 37.0956955], [10.19736195, 37.0956955], [10.19736195, 37.09541702], [10.19708347, 37.09541702], [10.19708347, 37.09513855], [10.196805, 37.09513855], [10.196805, 37.09486008], [10.19652653, 37.09486008], [10.19652653, 37.0945816], [10.19624901, 37.0945816], [10.19624901, 37.09430695], [10.19569302, 37.09430695], [10.19569302, 37.09402847], [10.1954174, 37.09402847], [10.1954174, 37.09375], [10.19513893, 37.09375], [10.19513893, 37.09347153], [10.19458294, 37.09347153], [10.19458294, 37.09319305], [10.19430542, 37.09319305], [10.19430542, 37.0929184], [10.19402695, 37.0929184], [10.19402695, 37.09263992], [10.19375134, 37.09263992], [10.19375134, 37.09236145], [10.19347095, 37.09236145], [10.19347095, 37.09208298], [10.19319534, 37.09208298], [10.19319534, 37.09152603], [10.19291687, 37.09152603], [10.19291687, 37.09125137], [10.19263935, 37.09125137], [10.19263935, 37.0909729], [10.19236088, 37.0909729], [10.19236088, 37.09069443], [10.19208336, 37.09069443], [10.19208336, 37.09041595], [10.19180489, 37.09041595], [10.19180489, 37.09013748], [10.19152737, 37.09013748], [10.19152737, 37.08986282], [10.19097328, 37.08986282], [10.19097328, 37.08958435], [10.19069481, 37.08958435], [10.19069481, 37.08930588], [10.19041729, 37.08930588], [10.19041729, 37.0890274], [10.19013882, 37.0890274], [10.19013882, 37.08874893], [10.1898613, 37.08874893], [10.1898613, 37.08847046], [10.18958282, 37.08847046], [10.18958282, 37.0881958], [10.18930531, 37.0881958], [10.18930531, 37.08763885], [10.18875122, 37.08763885], [10.18875122, 37.08736038], [10.18847466, 37.0873909], [10.18847275, 37.08680725], [10.18813324, 37.08683395], [10.18819523, 37.08652878], [10.18791676, 37.08652878], [10.18791676, 37.08625031], [10.18779087, 37.08625031], [10.18763924, 37.08625031], [10.18766212, 37.08596039], [10.18736076, 37.08597183], [10.18736076, 37.08569336], [10.18708324, 37.08569336], [10.18708324, 37.08541489], [10.18680668, 37.08541489], [10.18680668, 37.08514023], [10.18652916, 37.08514023], [10.18652916, 37.08486176], [10.18625069, 37.08486176], [10.18625069, 37.08458328], [10.18597317, 37.08458328], [10.18597317, 37.08430481], [10.18569469, 37.08430481], [10.18569469, 37.08402634], [10.18541718, 37.08402634], [10.18541718, 37.08375168], [10.1851387, 37.08375168], [10.1851387, 37.08347321], [10.18486023, 37.08347321], [10.18486023, 37.08291626], [10.18458462, 37.08291626], [10.18458462, 37.08263779], [10.18430424, 37.08263779], [10.18430424, 37.08235931], [10.18402863, 37.08235931], [10.18402863, 37.08208466], [10.18375111, 37.08208466], [10.18375111, 37.08180618], [10.18347168, 37.08180618], [10.18347168, 37.08152771], [10.18319416, 37.08152771], [10.18319416, 37.08097076], [10.18291569, 37.08097076], [10.18291569, 37.08069611], [10.18263817, 37.08069611], [10.18263817, 37.08041763], [10.18208218, 37.08041763], [10.18208218, 37.08013916], [10.18180561, 37.08013916], [10.18180561, 37.07958221], [10.18152809, 37.07958221], [10.18152809, 37.07902908], [10.18124962, 37.07902908], [10.18124962, 37.07847214], [10.1809721, 37.07847214], [10.1809721, 37.07791519], [10.18069363, 37.07791519], [10.18069363, 37.07736206], [10.18041611, 37.07736206], [10.18041611, 37.07680511], [10.18013763, 37.07680511], [10.18013763, 37.07624817], [10.17986012, 37.07624817], [10.17986012, 37.07347107], [10.17958355, 37.07347107], [10.17958355, 37.07291794], [10.17930603, 37.07291794], [10.17930412, 37.07208252], [10.17902756, 37.07208252], [10.17902756, 37.07152939], [10.17819405, 37.07152939], [10.17819405, 37.07180405], [10.17763805, 37.07180405], [10.17763805, 37.07208252], [10.17708397, 37.07208252], [10.17708397, 37.07180405], [10.17680645, 37.07180405], [10.17680645, 37.07152939], [10.17708397, 37.07152939], [10.17708397, 37.07125092], [10.17736244, 37.07125092], [10.17736244, 37.07097244], [10.17791557, 37.07097244], [10.17791557, 37.07069397], [10.17819405, 37.07069397], [10.17819405, 37.0704155], [10.17847157, 37.0704155], [10.17847157, 37.06986237], [10.17819405, 37.06986237], [10.17819405, 37.06902695], [10.17791557, 37.06902695], [10.17791557, 37.06624985], [10.17763805, 37.06624985], [10.17763805, 37.06458282], [10.17486191, 37.06458282], [10.17486191, 37.06430435], [10.17458439, 37.06430435], [10.17458439, 37.06402969], [10.1740284, 37.06402588], [10.1740284, 37.06375122], [10.17374992, 37.06375122], [10.17374992, 37.06347275], [10.1734724, 37.06347275], [10.1734724, 37.06319427], [10.17319584, 37.06319427], [10.17319584, 37.0629158], [10.17263985, 37.0629158], [10.17263985, 37.06263733], [10.17236233, 37.06263733], [10.17236233, 37.06236267], [10.17208385, 37.06236267], [10.17208385, 37.0620842], [10.17180634, 37.0620842], [10.17180634, 37.06124878], [10.17152786, 37.06124878], [10.17152786, 37.06069565], [10.17124939, 37.06069565], [10.17124939, 37.0601387], [10.17097092, 37.0601387], [10.17097092, 37.05902863], [10.1706934, 37.05902863], [10.1706934, 37.05708313], [10.17041779, 37.05708313], [10.17041779, 37.05680466], [10.17014027, 37.05680466], [10.17014027, 37.05652618], [10.16986084, 37.05652618], [10.16986084, 37.05625153], [10.16958332, 37.05625153], [10.16958332, 37.05486298], [10.16986084, 37.05486298], [10.16986084, 37.05430603], [10.17014027, 37.05430603], [10.17014027, 37.05355453], [10.17014027, 37.05236053], [10.17041779, 37.05236053], [10.17041779, 37.05208206], [10.1706934, 37.05208206], [10.1706934, 37.05152893], [10.17097092, 37.05152893], [10.17097092, 37.05125046], [10.17152786, 37.05125046], [10.17152786, 37.05097198], [10.17180634, 37.05097198], [10.17180634, 37.05041504], [10.17208385, 37.05041504], [10.17208385, 37.04986191], [10.17236233, 37.04986191], [10.17236233, 37.04958344], [10.17263985, 37.04958344], [10.17263985, 37.04930496], [10.17291641, 37.04930496], [10.17291641, 37.04902649], [10.17319584, 37.04902649], [10.17319584, 37.04875183], [10.1734724, 37.04875183], [10.1734724, 37.04819489], [10.17319584, 37.04819489], [10.17319584, 37.04680634], [10.17291641, 37.04680634], [10.17291641, 37.04569626], [10.17263985, 37.04569626], [10.17263985, 37.04541779], [10.17236233, 37.04541779], [10.17236233, 37.04486084], [10.17263985, 37.04486084], [10.17263985, 37.04458237], [10.17291641, 37.04458237], [10.17291641, 37.04430389], [10.17319584, 37.04430389], [10.17319584, 37.04375076], [10.1734724, 37.04375076], [10.1734724, 37.0436058], [10.1734724, 37.04319382], [10.17374992, 37.04319382], [10.17374992, 37.04270935], [10.17400265, 37.04264832], [10.1740284, 37.04236221], [10.17430592, 37.04236221], [10.17430592, 37.04180527], [10.17458439, 37.04180527], [10.17458439, 37.04152679], [10.17486191, 37.04152679], [10.17486191, 37.04124832], [10.17513847, 37.04124832], [10.17513847, 37.04097366], [10.17569447, 37.04097366], [10.17569447, 37.04041672], [10.1754179, 37.04041672], [10.1754179, 37.03874969], [10.17569447, 37.03874969], [10.17569447, 37.03819275], [10.17597198, 37.03819275], [10.17597198, 37.0368042], [10.17625046, 37.0368042], [10.17625046, 37.03569412], [10.17652798, 37.03569412], [10.17652798, 37.03541565], [10.17680645, 37.03541565], [10.17680645, 37.03569412], [10.17708397, 37.03569412], [10.17708397, 37.03652954], [10.17791557, 37.03652954], [10.17791557, 37.03625107], [10.17847157, 37.03625107], [10.17847157, 37.0359726], [10.17875004, 37.0359726], [10.17875004, 37.03458405], [10.17902756, 37.03458405], [10.17902756, 37.03180695], [10.17930412, 37.03180695], [10.17930603, 37.03152847], [10.17958355, 37.03152847], [10.17958355, 37.03097153], [10.17986012, 37.03097153], [10.17986012, 37.02958298], [10.18013763, 37.02958298], [10.18013763, 37.0293045], [10.18041611, 37.0293045], [10.18041611, 37.02902603], [10.1809721, 37.02902603], [10.1809721, 37.0293045], [10.18152809, 37.0293045], [10.18152809, 37.02958298], [10.18208218, 37.02958298], [10.18208218, 37.0293045], [10.18291569, 37.0293045], [10.18291569, 37.02902603], [10.18319416, 37.02902603], [10.18319416, 37.02791595], [10.18347168, 37.02791595], [10.18347168, 37.02708435], [10.18375111, 37.02708435], [10.18375111, 37.0265274], [10.18402863, 37.0265274], [10.18402863, 37.02597046], [10.18430424, 37.02597046], [10.18430424, 37.02541733], [10.18458462, 37.02541733], [10.18458462, 37.02513885], [10.18486023, 37.02513885], [10.18486023, 37.02458191], [10.1851387, 37.02458191], [10.1851387, 37.02402878], [10.18541718, 37.02402878], [10.18541718, 37.02375031], [10.18569469, 37.02375031], [10.18569469, 37.02347183], [10.18597317, 37.02347183], [10.18597317, 37.02319336], [10.18625069, 37.02319336], [10.18625069, 37.02236176], [10.18652916, 37.02236176], [10.18652916, 37.02208328], [10.18680668, 37.02208328], [10.18680668, 37.02125168], [10.18708324, 37.02125168], [10.18708324, 37.02097321], [10.18736458, 37.02097321], [10.18736076, 37.02069473], [10.18680668, 37.02069473], [10.18680668, 37.02041626], [10.18652916, 37.02041626], [10.18652916, 37.02013779], [10.18680668, 37.02013779], [10.18680668, 37.01985931], [10.18736076, 37.01985931], [10.18736076, 37.01958466], [10.18758869, 37.01958466], [10.18791676, 37.01958466], [10.18791676, 37.01930618], [10.18819523, 37.01930618], [10.18819523, 37.01902771], [10.18847275, 37.01902771], [10.18847275, 37.01874924], [10.18902683, 37.01874924], [10.18902683, 37.01847076], [10.18930531, 37.01847076], [10.18930531, 37.01819611], [10.1898613, 37.01819611], [10.1898613, 37.01791763], [10.19013882, 37.01791763], [10.19013882, 37.01819611], [10.19041729, 37.01819611], [10.19041729, 37.01763916], [10.19013882, 37.01763916], [10.19013882, 37.01736069], [10.1898613, 37.01736069], [10.1898613, 37.01652908], [10.19013882, 37.01652908], [10.19013882, 37.01625061], [10.19041729, 37.01625061], [10.19041729, 37.01597214], [10.19069481, 37.01597214], [10.19069481, 37.01486206], [10.19097328, 37.01486206], [10.19097328, 37.01458359], [10.19124889, 37.01458359], [10.19124889, 37.01402664], [10.19152737, 37.01402664], [10.19152737, 37.01374817], [10.19180489, 37.01374817], [10.19180489, 37.01263809], [10.19208336, 37.01263809], [10.19208336, 37.01208496], [10.19236088, 37.01208496], [10.19236088, 37.01152802], [10.19263935, 37.01152802], [10.19263935, 37.01124954], [10.19291687, 37.01124954], [10.19291687, 37.01041794], [10.19319534, 37.01041794], [10.19319534, 37.00912476], [10.19319534, 37.00875092], [10.19339371, 37.00875092], [10.19347095, 37.00875092], [10.19347095, 37.00624847], [10.19375134, 37.00624847], [10.19375134, 37.0051384], [10.19402695, 37.0051384], [10.19402695, 37.00402832], [10.19291687, 37.00402832], [10.19291687, 37.00374985], [10.19263935, 37.00374985], [10.19263935, 37.0031929], [10.19236088, 37.0031929], [10.19236088, 37.0023613], [10.19208336, 37.0023613], [10.19208336, 37.00180435], [10.19180489, 37.00180435], [10.19180489, 37.00125122], [10.19152737, 37.00125122], [10.19152737, 37.00013733], [10.19152737, 36.99986267], [10.19152737, 36.9995842], [10.19180489, 36.9995842], [10.19180489, 36.99902725], [10.19208336, 36.99902725], [10.19208336, 36.99874878], [10.19236088, 36.99874878], [10.19236088, 36.99791718], [10.19263935, 36.99791718], [10.19263935, 36.99736023], [10.19291687, 36.99736023], [10.19291687, 36.9968071], [10.19319534, 36.9968071], [10.19319534, 36.99652863], [10.19347095, 36.99652863], [10.19347095, 36.99597168], [10.19375134, 36.99597168], [10.19375134, 36.99541855], [10.19402695, 36.99541473], [10.19402695, 36.9948616], [10.19430542, 36.9948616], [10.19430542, 36.99430466], [10.19458294, 36.99430466], [10.19458294, 36.99375153], [10.19486141, 36.99375153], [10.19486141, 36.99347305], [10.19513893, 36.99347305], [10.19513893, 36.99319458], [10.1954174, 36.99319458], [10.1954174, 36.99291611], [10.19569302, 36.99291611], [10.19569302, 36.99263763], [10.19597435, 36.99263763], [10.19597435, 36.99236298], [10.19624901, 36.99236298], [10.19624901, 36.99180603], [10.19652653, 36.99180603], [10.19652653, 36.99152756], [10.196805, 36.99152756], [10.196805, 36.99097061], [10.19708347, 36.99097061], [10.19708347, 36.99072266], [10.19708347, 36.99041748], [10.19736195, 36.99041748], [10.19736195, 36.99013901], [10.19764042, 36.99013901], [10.19764042, 36.98958206], [10.19791794, 36.98958206], [10.19791794, 36.98902893], [10.1981926, 36.98902893], [10.1981926, 36.98875046], [10.19847107, 36.98875046], [10.19847107, 36.98847198], [10.19902802, 36.98847198], [10.19902802, 36.98764038], [10.19930553, 36.98764038], [10.19930553, 36.98680496], [10.19958401, 36.98680496], [10.19958401, 36.98625183], [10.19986153, 36.98625183], [10.19986153, 36.98597336], [10.20014, 36.98597336], [10.20014, 36.98569489], [10.20041561, 36.98569489], [10.20041561, 36.98541641], [10.20069408, 36.98541641], [10.20069408, 36.98485947], [10.2009716, 36.98485947], [10.2009716, 36.98430634], [10.20125008, 36.98430634], [10.20125008, 36.98402786], [10.2015276, 36.98402786], [10.2015276, 36.98374939], [10.20208359, 36.98374939], [10.20208359, 36.98347092], [10.20236206, 36.98347092], [10.20236206, 36.98319626], [10.20263767, 36.98319626], [10.20263767, 36.98291779], [10.20291805, 36.98291779], [10.20291805, 36.98236084], [10.20347214, 36.98236084], [10.20347214, 36.98208237], [10.20402813, 36.98208237], [10.20402813, 36.98180389], [10.20430565, 36.98180389], [10.20430565, 36.98152924], [10.20458412, 36.98152924], [10.20458412, 36.98069382], [10.20485973, 36.98069382], [10.20485973, 36.98041534], [10.20514011, 36.98041534], [10.20514011, 36.98014069], [10.20541573, 36.98014069], [10.20541573, 36.97986221], [10.20597172, 36.97986221], [10.20597172, 36.97958374], [10.20625019, 36.97958374], [10.20625019, 36.97930527], [10.20652771, 36.97930527], [10.20652771, 36.97902679], [10.20680618, 36.97902679], [10.20680618, 36.97874832], [10.2070837, 36.97874832], [10.2070837, 36.97847366], [10.20736027, 36.97847366], [10.20736027, 36.97819519], [10.20763779, 36.97819519], [10.20763779, 36.97735977], [10.20791626, 36.97735977], [10.20791626, 36.97680664], [10.20819378, 36.97680664], [10.20819378, 36.97652817], [10.20847225, 36.97652817], [10.20847225, 36.97597122], [10.20874977, 36.97597122], [10.20874977, 36.97569275], [10.20902824, 36.97569275], [10.20902824, 36.97513962], [10.20930576, 36.97513962], [10.20930576, 36.97486115], [10.20958233, 36.97486115], [10.20958233, 36.97458267], [10.20985985, 36.97458267], [10.20985985, 36.9743042], [10.21069431, 36.9743042], [10.21069431, 36.97402954], [10.21097279, 36.97402954], [10.21097279, 36.97319412], [10.21125126, 36.97319412], [10.21125126, 36.97236252], [10.21152878, 36.97236252], [10.21152878, 36.97180557], [10.21180439, 36.97180557], [10.21180439, 36.9715271], [10.21208191, 36.9715271], [10.21208191, 36.97124863], [10.21236134, 36.97124863], [10.21236134, 36.97097397], [10.21291733, 36.97097397], [10.21291733, 36.9706955], [10.21347332, 36.9706955], [10.21347332, 36.97041702], [10.21375084, 36.97041702], [10.21375084, 36.97013855], [10.2145834, 36.97013855], [10.2145834, 36.9695816], [10.21541691, 36.9695816], [10.21541691, 36.96930695], [10.21569538, 36.96930695], [10.21569538, 36.96875], [10.2159729, 36.96875], [10.2159729, 36.96847153], [10.21652889, 36.96847153], [10.21652889, 36.9679184], [10.21708298, 36.9679184], [10.21708298, 36.96736145], [10.21680546, 36.96736145], [10.21680546, 36.96708298], [10.21736145, 36.96708298], [10.21736145, 36.96625137], [10.21763897, 36.96625137], [10.21763897, 36.9659729], [10.21819496, 36.9659729], [10.21819496, 36.96569443], [10.21902657, 36.96569443], [10.21902657, 36.96541595], [10.21930504, 36.96541595], [10.21930504, 36.96513748], [10.21986103, 36.96513748], [10.21986103, 36.96486282], [10.22013855, 36.96486282], [10.22013855, 36.96458435], [10.22097111, 36.96458435], [10.22097111, 36.96430588], [10.22124863, 36.96430588], [10.22124863, 36.9640274], [10.2215271, 36.9640274], [10.2215271, 36.96374893], [10.22180462, 36.96374893], [10.22180462, 36.96347046], [10.22208309, 36.96347046], [10.22208309, 36.9631958], [10.22236061, 36.9631958], [10.22236061, 36.96263885], [10.22263908, 36.96263885], [10.22263908, 36.96236038], [10.2229166, 36.96236038], [10.2229166, 36.96208191], [10.22347355, 36.96208191], [10.22347355, 36.96180725], [10.22374916, 36.96180725], [10.22374916, 36.96152878], [10.22402668, 36.96152878], [10.22402668, 36.96125031], [10.22430515, 36.96125031], [10.22430515, 36.96097183], [10.22458363, 36.96097183], [10.22458363, 36.96069336], [10.22513962, 36.96069336], [10.22513962, 36.96041489], [10.22541523, 36.96041489], [10.22541809, 36.96014023], [10.22597218, 36.96014023], [10.22597218, 36.96041489], [10.22624969, 36.96041489], [10.22624969, 36.96014023], [10.22652817, 36.96014023], [10.22652817, 36.95986176], [10.22680569, 36.95986176], [10.22680569, 36.96014023], [10.22708416, 36.96014023], [10.22708416, 36.95986176], [10.22736168, 36.95986176], [10.22736168, 36.95958328], [10.22764015, 36.95958328], [10.22764015, 36.95930481], [10.22791576, 36.95930481], [10.22791576, 36.95902634], [10.22847176, 36.95902634], [10.22847176, 36.95875168], [10.22902775, 36.95875168], [10.22902775, 36.95847321], [10.22930622, 36.95847321], [10.22930622, 36.95819473], [10.22986221, 36.95819473], [10.22986221, 36.95791626], [10.2304163, 36.95790482], [10.2304163, 36.95763779], [10.2300787, 36.95578003], [10.23047638, 36.9552803], [10.23429966, 36.95047379], [10.23649025, 36.94771957], [10.24672127, 36.93952942], [10.24975395, 36.93484879], [10.25909424, 36.93154144], [10.26851177, 36.92385864], [10.27371693, 36.91989136], [10.27470779, 36.9109726], [10.28115177, 36.90626144], [10.28115177, 36.9010582], [10.27470779, 36.89733887], [10.27322102, 36.89510727], [10.27148628, 36.89287949], [10.27148628, 36.88916016], [10.27117825, 36.88873672], [10.26950359, 36.88643646], [10.26702499, 36.88197327], [10.26875973, 36.87825775], [10.27123928, 36.87528229], [10.27644253, 36.87181091], [10.2801609, 36.87156296], [10.27902508, 36.87061691], [10.27718735, 36.86908722], [10.27223015, 36.86338425], [10.25265121, 36.86487198], [10.23926735, 36.8658638], [10.23762226, 36.86458588], [10.23753262, 36.86511993], [10.23406315, 36.86536789], [10.22638035, 36.86536789], [10.22315788, 36.86710358], [10.22290993, 36.8735466], [10.22290993, 36.87565231], [10.2222414, 36.87585449], [10.2191906, 36.87585449], [10.21506405, 36.87298584], [10.20806694, 36.8695755], [10.20196629, 36.86293793], [10.20232487, 36.85611725], [10.19313335, 36.85655975], [10.18743324, 36.85683441], [10.1811533, 36.85719681], [10.17706013, 36.85617065], [10.17612934, 36.85593796], [10.17056656, 36.85540009], [10.16697884, 36.85522079], [10.16410828, 36.85199356], [10.16016102, 36.85163116], [10.15441895, 36.85217285], [10.14993382, 36.85414505], [10.1440134, 36.85863113], [10.13701534, 36.86239624], [10.13153744, 36.86381531], [10.12912083, 36.86473083], [10.12104702, 36.86293793], [10.11279297, 36.86239624], [10.1085062, 36.85918427], [10.10630989, 36.85467148], [10.10574913, 36.85351944], [10.10153103, 36.84589005], [10.10088825, 36.84523392], [10.10013866, 36.84446716], [10.09455013, 36.83874893], [10.08789825, 36.83372116], [10.08691883, 36.83298111], [10.08026409, 36.82851028], [10.07346725, 36.83100128], [10.07143688, 36.83174515], [10.05622768, 36.84280777]]]]}
#     }
    
    tiffs = ["cog_tree-density.tif",
            "cog_hanpp-pcp.tif",
            "cog_rue.tif",
            "cog_pop-den-rural.tif",
            "cog_dist-twn.tif",
            "cog_pop-den2015.tif",
            "cog_slope-deg.tif",
            "cog_gdpcap.tif",
            "cog_dist-rd.tif",
            "cog_npp-gap.tif",
            "cog_gdpcap-grw.tif",
            "cog_dem-gtopo30.tif",
            "cog_pop-change.tif",
            "cog_aridity.tif"]
            
    
    
    
    ### GET
    # data_input_json = s3.get_object(Bucket=bucket, Key=key)
        
    # json_data = data_input_json["Body"].read()
    # json_file = json.loads(json_data)
    
    # return json.dumps(json_file)
    
    
    ### POST
    
    # json_file = not key # check if it is empty
    # json_file = key
    
    body = json.loads(event['body'])
    json_file = body
    
    
    ## Catch errors
    
    try:
        geojson_dict = json_file["area"]
    except Exception as e:
        return {
            'statusCode': 502,
            'body': str(e),
            'json': json_file # einai adeio
        }
        
    if bool(geojson_dict)==False:
        return {
            'statusCode': 502,
            'body': "Invalid GeoJSON"
        }
    
        ## files with real numbers that mean has meaning to be applied

    gdal_warp_kwargs = {
        'format': 'GTiff',
        'cutlineDSName' : json.dumps(geojson_dict),
        'cropToCutline' : True,
        'dstNodata' : -32768,
        'creationOptions' : ['COMPRESS=DEFLATE']
        }
    
    ## get area data from s3 based on geojson and files that can be processed with mean function
    
    for file in tiffs:
        #create the paths used
        s3_file_path = '/vsis3/geoc-cog-workspace/' + file
        #discard cog_ at the bigging of the file name
        local_save_file_name = file.split("_")[1]
        save_temp_file_path = "/tmp/" + local_save_file_name
        #execute the data transfer and save result
        gdal.Warp(save_temp_file_path,s3_file_path,**gdal_warp_kwargs)
    
    ## find only tiff files to be processed 
    files = os.listdir("/tmp/")
    files = [x for x in files if x.endswith("tif")]
    
    # #1 clean number unit?
    # #2 boolean and classes mean doesn't make sense
    # #3 descriptive units are ok?
    # #4 at sqc data, at footnotes, footnote 2 says 10 classes while the related table says 4
    
    data_info = {
        'aridity.tif' : {
            "variable" : "ARIDITY",
            "value" : None,
            "unit" : "clean"
        },
        'cover-broad.tif' : {
            "variable" : "BROAD-COVER",
            "value" : None,
            "unit" : "10_classes"
        },
        'dem-gtopo30.tif' : {
            "variable" : "DEM-GTOPO30",
            "value" : None,
            "unit" : "m"
        },
        'dist-rd.tif' : {
            "variable" : "DIST-ROAD",
            "value" : None,
            "unit" : "km"
        },
        'dist-twn.tif' : {
            "variable" : "DIST-TOWN",
            "value" : None,
            "unit" : "km"
        },
        'gdpcap-grw.tif' : {
            "variable" : "GDPCAP-GRW",
            "value" : None,
            "unit" : "percentage"
        },
        'gdpcap.tif' : {
            "variable" : "GDPCAP",
            "value" : None,
            "unit" : "$/person/year"
        },
        'gls-asselen.tif' : {
            "variable" : "NA",
            "value" : None,
            "unit" : "NA"
        },
        'hanpp-pcp.tif' : {
            "variable" : "HANPP_PCT",
            "value" : None,
            "unit" : "percentage"
        },
        'lsa-vaclavik.tif' : {
            "variable" : "NA",
            "value" : None,
            "unit" : "NA"
        },
        'npp-gap.tif' : {
            "variable" : "NPP-GAPPC",
            "value" : None,
            "unit" : "percentage"
        },
        'pop-change.tif' : {
            "variable" : "POP-CHANGE",
            "value" : None,
            "unit" : "persons/km2"
        },
        'pop-den-rural.tif' : {
            "variable" : "POP-DEN-RURAL",
            "value" : None,
            "unit" : "persons/km2"
        },
        'pop-den2015.tif' : {
            "variable" : "POP-DEN2015",
            "value" : None,
            "unit" : "persons/km2"
        },
        'prec-trend.tif' : {
            "variable" : "PRECIP-TREND",
            "value" : None,
            "unit" : "floating_trend_coefficient"
        },
        'prod-degrad.tif' : {
            "variable" : "PROD-DEG",
            "value" : None,
            "unit" : "boolean"
        },
        'prod-improv.tif' : {
            "variable" : "PROD-IMP",
            "value" : None,
            "unit" : "bolean"
        },
        'protect-area.tif' : {
            "variable" : "PROTECT-AREA",
            "value" : None,
            "unit" : "boolean"
        },
        'rue.tif' : {
            "variable" : "RUE",
            "value" : None,
            "unit" : "Rain use efficiency = mean of annual sum NDVI /annual rainfall"
        },
        'ses-type.tif' : {
            "variable" : "SES-TYPE",
            "value" : None,
            "unit" : "12_classes"
        },
        'slope-deg.tif' : {
            "variable" : "SLOPE-DEG",
            "value" : None,
            "unit" : "degree"
        },
        'sqc1-nutava.tif' : {
            "variable" : "SQC1-NUTAVA",
            "value" : None,
            "unit" : "4_classes"
        },
        'sqc2-nutrcap.tif' : {
            "variable" : "SQC2-NUTRCAP",
            "value" : None,
            "unit" : "4_classes"
        },
        'sqc3-rootcod.tif' : {
            "variable" : "SQC3-ROOTCOD",
            "value" : None,
            "unit" : "4_classes"
        },
        'sqc4-oxygen.tif' : {
            "variable" : "SQC4-OXYGEN",
            "value" : None,
            "unit" : "4_classes"
        },
        'sqc5-salt.tif' : {
            "variable" : "SQC5-SALT",
            "value" : None,
            "unit" : "4_classes"
        },
        'sqc6-toxicity.tif' : {
            "variable" : "SQC6-TOXICITY",
            "value" : None,
            "unit" : "4_classes"
        },
        'sqc7-workcap.tif' : {
            "variable" : "SQC7-WORKAP",
            "value" : None,
            "unit" : "4_classes"
        },
        'tree-density.tif' :{
            "variable" : "TREE-DEN",
            "value" : None,
            "unit" : "trees/km2"
        }
    }

    
    #output json bulding blocks
    output_block = {
        "dataset" : None,
        "variable" : None,
        "value" : None,
        "unit" : None
    }
    
    output = {
        "results" : []
    }
    
    #process all files
    for file in files:
    
        #open files
        file_array = gdal.Open("/tmp/" + file).ReadAsArray()
        #mask no data values
        file_array = ma.array(file_array,mask=file_array<=-9999,fill_value=-9999)
        #compute mean
        mean_value = np.mean(file_array)
        
        #fill the building block
        output_block["dataset"] = file
        output_block["variable"] = data_info[file]["variable"]
        output_block["value"] = mean_value
        output_block["unit"] = data_info[file]["unit"]
        
        #append block to the final list for the json output
        output["results"].append(copy.copy(output_block))
    
    return {
        'statusCode': 200,
        'body': json.dumps(output)
    }
    